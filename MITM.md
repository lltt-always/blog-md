---
title: MITM中间人攻击
tags: Network security
---

举例说明中间人攻击

<!--more-->

MITM(Man-in-the-middle-attack)，中间人攻击，是指攻击者与通讯的两端分别创建独立的联系，并交换其所受到的数据，使通讯的两端认为他们在通过一个私密的连接于对方直接对话，但实际上整个会话都被攻击者完全控制。

## 举个栗子
*爱丽丝 马洛里 鲍勃*
```
爱丽丝“嗨，鲍勃，我是爱丽丝。给我你的公钥” --> 马洛里 鲍勃
爱丽丝 马洛里“嗨，鲍勃，我是爱丽丝。给我你的公钥” --> 鲍伯
爱丽丝 马洛里<-- [鲍伯的公钥]-- 鲍伯
爱丽丝<-- [马洛里的公钥]-- 马洛里 鲍勃
爱丽丝“我们在公共汽车站见面！”--[使用马洛里的公钥加密] --> 马洛里 鲍勃
爱丽丝 马洛里“在家等我！”--[使用鲍伯的公钥加密] --> 鲍伯
```

重点：通讯两端身份验证

## 攻击
- ARP投毒
 - 主机C冒充网关欺骗主机B
   只能窃取受攻击主机的外发数据包，无法接受到从远程服务端返回的返回数据包，无法进行流量内容修改，流量注入。  
   ![img](../images/ARP01.png)
 - 攻击者仅欺骗被攻击主机，同事在本地进行Iptable NAT转发
   由于使用了NAT技术，从服务端返回的数据包也会经过攻击者的主机了，这样，攻击者就可以在本地进行流量内容的修改、流量注入了  
   ![img](../images/ARP02.png)  
 - 攻击者同事欺骗被攻击主机和网关
   在双向ARP欺骗中，攻击者仅仅充当了一个"数据包路由转发"的角色，将两个方向的数据包都进行转发。
   ![img](../images/ARP03.png)

后续内容可参考[中间人攻击(MITM)姿势总结](http://www.cnblogs.com/LittleHann/p/3735602.html)

## 防御
- PKI相互认证机制：应用程序验证用户<——>用户设备验证应用程序，对正规软件有效
- 延迟测试
- 第二通道校验

更多信息可
